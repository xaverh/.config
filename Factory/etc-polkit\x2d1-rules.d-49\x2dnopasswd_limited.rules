polkit.addRule(function(action, subject) {
	if (action.id == 'org.freedesktop.systemd1.manage-units') {
		if (
			subject.isInGroup('wheel') &&
			(/wg-quick@mullvad\-[a-z]+[0-9]+.service/.test(
				action.lookup('unit')
			) ||
				action.lookup('unit') == 'iwd.service')
		) {
			var verb = action.lookup('verb')
			if (verb == 'start' || verb == 'stop' || verb == 'restart') {
				return polkit.Result.YES
			}
		}
	}
})

polkit.addRule(function(action, subject) {
	if (
		action.id == 'org.freedesktop.policykit.exec' &&
		action.lookup('program') == '/usr/bin/resolvectl'
	) {
		return polkit.Result.YES
	}
})
