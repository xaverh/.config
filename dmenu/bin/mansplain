#!/usr/bin/zsh

font=${PANEL_XFT_FONT:-"SGI Screen:pixelsize=14"}
bgcolor=${PANEL_BG_COLOR:-"#000000"}
fgcolor=${PANEL_FG_COLOR:-"#ffffff"}
bgselcolor=${PANEL_BG_SEL_COLOR:-"#005577"}
fgselcolor=${PANEL_FG_SEL_COLOR:-"#ffffff"}

mkdir -p /tmp/mansplain/`date +"%G-%V"`
manpage=`apropos . | dmenu -l 30 -i -f -fn "$font" -sf "$fgselcolor" -sb "$bgselcolor" -nb "$bgcolor" -nf "$fgcolor" | awk '{gsub(/[()]/,""); print $2" "$1}'`
filename="/tmp/mansplain/`date +"%G-%V"`/${^manpage}.pdf"
[[ -f "$filename" ]] || man -Tpdf ${=manpage} > "$filename"
bspc rule --add \* --one-shot center=on state=floating
mupdf-gl -r 96 "$filename"